{
  "hash": "e7804e2d2bec4996ff3089091f7202f7",
  "result": {
    "markdown": "---\ntitle: \"Take-home Exercise 1: Creating Visualization Beyond Default - Singapore Private Residential Property Market for 2024 Q1\"\nauthor: \"Kristine Joy Paas\"\ndate: \"16 April 2024\"\ndate-modified: \"last-modified\"\nformat: html\nexecute: \n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n# 1 Overview\n\n## 1.1 Background\n\nSingapore has one of the highest home ownership rates in the world at 89.7%, [2nd only to Russia among the G20](https://tradingeconomics.com/country-list/home-ownership-rate?continent=g20) countries. Due to Singapore's successful public housing program, [77.8% of Singapore residents live in HDB flats](13+%20Housing%20&%20Household%20Statistics%20in%20Singapore%20(2024)), while 22% live in private properties like condos or landed properties.\n\nWhile the HDB market targets Singaporeans with household income of up to 14,000 SGD, the private housing market is Singapore is still in demand for households looking to upgrade, invest their property, and for residents not eligible for public housing (e.g. high income household, foreigners, etc.)\n\nIn this exercise we will look at the market trends for private residential property market for 2024 Q1 and see how the economic factors have affected it.\n\n## 1.2 Loading the data sources\n\nFor this exercise, we will use the residential real estate transaction data from [REALIS](https://www.ura.gov.sg/reis/index). This provides comprehensive and up-to-date statistics on the private property market in Singapore.\n\nThe dataset has been provided via eLearn and added to the `data/` folder of this exercise.\n\n::: {.callout-note collapse=\"true\"}\n### File Structure\n\n![](images/file_structure.png)\n:::\n\nFor the purposes of this exercise, we will refer to each data as the following:\n\n-   **2023Q1**: `ResidentialTransaction20240308160536.csv`\n\n-   **2023Q2**: `ResidentialTransaction20240308160736.csv`\n\n-   **2023Q3**: `ResidentialTransaction20240308161009.csv`\n\n-   **2023Q4**: `ResidentialTransaction20240308161109.csv`\n\n-   **2024Q1**: `ResidentialTransaction20240414220633.csv`\n\n## 1.3 Methodology\n\nTo start the data analysis, we first need to prepare the R environment for analysis. This includes loading the R packages and loading the datasets.\n\nAfter the setup, we need to do data wrangling where we clean and transform the data into a form that is fitting for our analysis. This will possible entail removing irrelevant data, deriving additional variables, renaming columns, etc.\n\nNext, we need to decide on what data we would like to look at closely. For the purposes of this exercise, these are the data we can look at that can potentially give valuable insights:\n\n-   Total units sold by quarter\n\n-   Units sold by submarkets such as property type (e.g. landed, strata), sale type (e.g. resale, new sale, subsale), etc.\n\n-   Transaction price by submarkets such property type (e.g. landed, strata), sale type (e.g. resale, new sale, subsale), etc.\n\nFinally, we will do data exploration and visualize the insights gained from the data. Some of the questions we would ask are:\n\n-   What is the general quarterly trend of private residential property sales prices?\n\n-   Is this trend consistent among all submarkets?\n\n-   How affordable are private residential properties for Singaporean households?\n\n# 2 Setup\n\n## 2.1 Loading the R packages\n\nFor this exercise, we will mainly use the following packages:\n\n-   [tidyverse](https://www.tidyverse.org/): collection of R packages used in data science, which includes [ggplot2](https://ggplot2.tidyverse.org/), [tibble](https://tibble.tidyverse.org/), [readr](https://readr.tidyverse.org/), among others\n-   ggtext: Enhanced text formating\n-   ggdist: half_eye plot\n\nAside from these, we will also include other packages that will help us present the data better.\n\n-   [knitr](https://www.rdocumentation.org/packages/knitr/versions/1.45): used for dynamic report generation in R. For this exercise, we will use this package to render our tables better.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(knitr, tidyverse, patchwork, ggdist, ggtext, ggpubr, treemapify)\n```\n:::\n\n\n## 2.2 Data Checkpoints\n\nAs the analysis is expected to have a lot of intermediate steps, **Save**, **Load**, and **Data clear** points are available to make our data wrangling more efficient.\n\n::: callout-tip\n### Save point\n\nThis is where data is written as `rds` files using `write_rds()` for important data sets that will be used in later analysis. Examples are:\n\n-   Data we need to prepare for analysis\n-   Critical outputs of expensive calculations\n-   Cleaned up data for lightweight processing\n:::\n\n::: callout-note\n### Load point\n\nThis is where data is loaded from `rds` files using `read_rds()`. They were previously generated by the save point.\n\n**TIP**: Skip to the load points to progress without running the code above it\n:::\n\n::: callout-warning\n### Data clear point\n\nThis is where data that will not be used anymore are cleared. The data in RStudio environment will pile up and will make it more difficult to check the relevant data in each part.\n\nWe can set `#| eval: false` in code chunks if we want skip the clearing. For example, the code below won't be run.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmessage <- \"This code chunk executed\"\n```\n:::\n\n:::\n\nTo use these checkpoints, we need to create `data/rds` folder.\n\n# 3 Data Wrangling\n\n## 3.1 Importing the datasets\n\nUpon inspection of the csv files, column names have human-readable titles such as \"Project Name\", \"Transacted Price (\\$)\", etc. While good for humans, these column names may cause parsing issues with R, especially as there are special characters.\n\nBecause of this, we will rename the columns in their UPPER_CASE format after removing the special characters. We will create a helper function that will help us accomplish this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrename_realis_column <- function(orig_name) {\n  # Add underscores to spaces\n  gsub(\" +\", \"_\",\n       # Remove special characters\n       gsub(\"[^A-Z ]\", \"\",\n            # Convert to upper case and remove trailing spaces\n            toupper(orig_name)) %>% trimws())\n}\n```\n:::\n\n\nWe will use `read_csv()` to import each file and use `rename_realis_column()` in the `rename_with()` function.\n\n::: panel-tabset\n### 2023 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_2023q1 <- read_csv('data/ResidentialTransaction20240308160536.csv') %>%\n                  rename_with(rename_realis_column)\nkable(head(realis_2023q1, n=7))\n```\n\n::: {.cell-output-display}\n|PROJECT_NAME            | TRANSACTED_PRICE| AREA_SQFT| UNIT_PRICE_PSF|SALE_DATE   |ADDRESS                       |TYPE_OF_SALE |TYPE_OF_AREA | AREA_SQM| UNIT_PRICE_PSM|NETT_PRICE |PROPERTY_TYPE         | NUMBER_OF_UNITS|TENURE                  |COMPLETION_DATE |PURCHASER_ADDRESS_INDICATOR |POSTAL_CODE |POSTAL_DISTRICT |POSTAL_SECTOR |PLANNING_REGION   |PLANNING_AREA |\n|:-----------------------|----------------:|---------:|--------------:|:-----------|:-----------------------------|:------------|:------------|--------:|--------------:|:----------|:---------------------|---------------:|:-----------------------|:---------------|:---------------------------|:-----------|:---------------|:-------------|:-----------------|:-------------|\n|THE REEF AT KING'S DOCK |          2317000|    882.65|           2625|01 Jan 2023 |12 HARBOURFRONT AVENUE #05-32 |New Sale     |Strata       |     82.0|          28256|-          |Condominium           |               1|99 yrs from 12/01/2021  |Uncompleted     |HDB                         |097996      |04              |09            |Central Region    |Bukit Merah   |\n|URBAN TREASURES         |          1823500|    882.65|           2066|02 Jan 2023 |205 JALAN EUNOS #08-02        |New Sale     |Strata       |     82.0|          22238|-          |Condominium           |               1|Freehold                |Uncompleted     |Private                     |419535      |14              |41            |East Region       |Bedok         |\n|NORTH GAIA              |          1421112|   1076.40|           1320|02 Jan 2023 |29 YISHUN CLOSE #08-10        |New Sale     |Strata       |    100.0|          14211|-          |Executive Condominium |               1|99 yrs from 15/02/2021  |Uncompleted     |HDB                         |269343      |27              |26            |North Region      |Yishun        |\n|NORTH GAIA              |          1258112|   1033.34|           1218|02 Jan 2023 |45 YISHUN CLOSE #07-42        |New Sale     |Strata       |     96.0|          13105|-          |Executive Condominium |               1|99 yrs from 15/02/2021  |Uncompleted     |HDB                         |269294      |27              |26            |North Region      |Yishun        |\n|PARC BOTANNIA           |          1280000|    871.88|           1468|03 Jan 2023 |12 FERNVALE STREET #06-16     |Resale       |Strata       |     81.0|          15802|-          |Condominium           |               1|99 yrs from 28/12/2016  |2022            |HDB                         |797391      |28              |79            |North East Region |Sengkang      |\n|NANYANG PARK            |          5870000|   3322.85|           1767|03 Jan 2023 |72 JALAN LIMBOK               |Resale       |Land         |    308.7|          19015|-          |Terrace House         |               1|999 yrs from 14/02/1881 |-               |Private                     |548742      |19              |54            |North East Region |Hougang       |\n|PALMS @ SIXTH AVENUE    |          4950000|   4520.88|           1095|03 Jan 2023 |231 SIXTH AVENUE              |Resale       |Strata       |    420.0|          11786|-          |Semi-Detached House   |               1|Freehold                |2015            |Private                     |275780      |10              |27            |Central Region    |Bukit Timah   |\n:::\n:::\n\n\nThere are **4,722** private residential propertysales for 2023 Q1.\n\n### 2023 Q2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_2023q2 <- read_csv('data/ResidentialTransaction20240308160736.csv') %>%\n                  rename_with(rename_realis_column)\nkable(head(realis_2023q2, n=7))\n```\n\n::: {.cell-output-display}\n|PROJECT_NAME    | TRANSACTED_PRICE| AREA_SQFT| UNIT_PRICE_PSF|SALE_DATE   |ADDRESS                  |TYPE_OF_SALE |TYPE_OF_AREA | AREA_SQM| UNIT_PRICE_PSM|NETT_PRICE |PROPERTY_TYPE | NUMBER_OF_UNITS|TENURE                 |COMPLETION_DATE |PURCHASER_ADDRESS_INDICATOR |POSTAL_CODE |POSTAL_DISTRICT |POSTAL_SECTOR |PLANNING_REGION   |PLANNING_AREA |\n|:---------------|----------------:|---------:|--------------:|:-----------|:------------------------|:------------|:------------|--------:|--------------:|:----------|:-------------|---------------:|:----------------------|:---------------|:---------------------------|:-----------|:---------------|:-------------|:-----------------|:-------------|\n|THE GAZANIA     |          1528000|    678.13|           2253|01 Apr 2023 |15 HOW SUN DRIVE #02-31  |New Sale     |Strata       |       63|          24254|-          |Condominium   |               1|Freehold               |2022            |N.A                         |538545      |19              |53            |North East Region |Serangoon     |\n|THE GAZANIA     |          1938000|    958.00|           2023|01 Apr 2023 |7 HOW SUN DRIVE #01-12   |New Sale     |Strata       |       89|          21775|-          |Condominium   |               1|Freehold               |2022            |Private                     |538530      |19              |53            |North East Region |Serangoon     |\n|ONE PEARL BANK  |          2051000|    699.66|           2931|01 Apr 2023 |1 PEARL BANK #32-16      |New Sale     |Strata       |       65|          31554|-          |Apartment     |               1|99 yrs from 01/03/2019 |Uncompleted     |Private                     |169016      |03              |16            |Central Region    |Outram        |\n|URBAN TREASURES |          1850700|    882.65|           2097|01 Apr 2023 |205 JALAN EUNOS #05-05   |New Sale     |Strata       |       82|          22570|-          |Condominium   |               1|Freehold               |Uncompleted     |HDB                         |419535      |14              |41            |East Region       |Bedok         |\n|HYLL ON HOLLAND |          2021500|    699.66|           2889|01 Apr 2023 |97 HOLLAND ROAD #10-25   |New Sale     |Strata       |       65|          31100|-          |Condominium   |               1|Freehold               |Uncompleted     |Private                     |278541      |10              |27            |Central Region    |Bukit Timah   |\n|LEEDON GREEN    |          1838000|    785.77|           2339|01 Apr 2023 |34 LEEDON HEIGHTS #12-40 |New Sale     |Strata       |       73|          25178|-          |Condominium   |               1|Freehold               |Uncompleted     |Private                     |266076      |10              |26            |Central Region    |Bukit Timah   |\n|KLIMT CAIRNHILL |          7320000|   2055.92|           3560|01 Apr 2023 |71 CAIRNHILL ROAD #15-01 |New Sale     |Strata       |      191|          38325|-          |Apartment     |               1|Freehold               |Uncompleted     |Private                     |229725      |09              |22            |Central Region    |Newton        |\n:::\n:::\n\n\nThere are **6,125** private residential property sales for 2023 Q2.\n\n### 2023 Q3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_2023q3 <- read_csv('data/ResidentialTransaction20240308161009.csv') %>%\n                  rename_with(rename_realis_column)\nkable(head(realis_2023q3, n=7))\n```\n\n::: {.cell-output-display}\n|PROJECT_NAME     | TRANSACTED_PRICE| AREA_SQFT| UNIT_PRICE_PSF|SALE_DATE   |ADDRESS                        |TYPE_OF_SALE |TYPE_OF_AREA | AREA_SQM| UNIT_PRICE_PSM|NETT_PRICE |PROPERTY_TYPE         | NUMBER_OF_UNITS|TENURE                 |COMPLETION_DATE |PURCHASER_ADDRESS_INDICATOR |POSTAL_CODE |POSTAL_DISTRICT |POSTAL_SECTOR |PLANNING_REGION |PLANNING_AREA |\n|:----------------|----------------:|---------:|--------------:|:-----------|:------------------------------|:------------|:------------|--------:|--------------:|:----------|:---------------------|---------------:|:----------------------|:---------------|:---------------------------|:-----------|:---------------|:-------------|:---------------|:-------------|\n|MYRA             |          1658000|    667.37|           2484|01 Jul 2023 |9 MEYAPPA CHETTIAR ROAD #02-07 |New Sale     |Strata       |       62|          26742|-          |Apartment             |               1|Freehold               |Uncompleted     |N.A                         |358456      |13              |35            |Central Region  |Toa Payoh     |\n|NORTH GAIA       |          1449000|   1076.40|           1346|01 Jul 2023 |27 YISHUN CLOSE #10-06         |New Sale     |Strata       |      100|          14490|-          |Executive Condominium |               1|99 yrs from 15/02/2021 |Uncompleted     |HDB                         |769342      |27              |76            |North Region    |Yishun        |\n|NORTH GAIA       |          1365000|   1076.40|           1268|01 Jul 2023 |27 YISHUN CLOSE #05-06         |New Sale     |Strata       |      100|          13650|-          |Executive Condominium |               1|99 yrs from 15/02/2021 |Uncompleted     |HDB                         |769342      |27              |76            |North Region    |Yishun        |\n|NORTH GAIA       |          1231000|    958.00|           1285|01 Jul 2023 |35 YISHUN CLOSE #08-25         |New Sale     |Strata       |       89|          13831|-          |Executive Condominium |               1|99 yrs from 15/02/2021 |Uncompleted     |HDB                         |769299      |27              |76            |North Region    |Yishun        |\n|NORTH GAIA       |          1272000|   1001.05|           1271|01 Jul 2023 |45 YISHUN CLOSE #09-45         |New Sale     |Strata       |       93|          13677|-          |Executive Condominium |               1|99 yrs from 15/02/2021 |Uncompleted     |HDB                         |769294      |27              |76            |North Region    |Yishun        |\n|PICCADILLY GRAND |          3462000|   1679.18|           2062|01 Jul 2023 |3 NORTHUMBERLAND ROAD #14-09   |New Sale     |Strata       |      156|          22192|-          |Apartment             |               1|99 yrs from 02/08/2021 |Uncompleted     |Private                     |219569      |08              |21            |Central Region  |Kallang       |\n|TENET            |          1356000|    925.70|           1465|01 Jul 2023 |71 TAMPINES STREET 62 #14-02   |New Sale     |Strata       |       86|          15767|-          |Executive Condominium |               1|99 yrs from 01/11/2021 |Uncompleted     |HDB                         |529699      |18              |52            |East Region     |Tampines      |\n:::\n:::\n\n\nThere are **6,206** private residential property sales for 2023 Q3.\n\n### 2023 Q4\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_2023q4 <- read_csv('data/ResidentialTransaction20240308161109.csv') %>%\n                  rename_with(rename_realis_column)\nkable(head(realis_2023q4, n=7))\n```\n\n::: {.cell-output-display}\n|PROJECT_NAME              | TRANSACTED_PRICE| AREA_SQFT| UNIT_PRICE_PSF|SALE_DATE   |ADDRESS                     |TYPE_OF_SALE |TYPE_OF_AREA | AREA_SQM| UNIT_PRICE_PSM|NETT_PRICE |PROPERTY_TYPE | NUMBER_OF_UNITS|TENURE                 |COMPLETION_DATE |PURCHASER_ADDRESS_INDICATOR |POSTAL_CODE |POSTAL_DISTRICT |POSTAL_SECTOR |PLANNING_REGION   |PLANNING_AREA |\n|:-------------------------|----------------:|---------:|--------------:|:-----------|:---------------------------|:------------|:------------|--------:|--------------:|:----------|:-------------|---------------:|:----------------------|:---------------|:---------------------------|:-----------|:---------------|:-------------|:-----------------|:-------------|\n|LEEDON GREEN              |          1749000|    538.20|           3250|01 Oct 2023 |26 LEEDON HEIGHTS #11-08    |New Sale     |Strata       |       50|          34980|-          |Condominium   |               1|Freehold               |Uncompleted     |Private                     |266221      |10              |26            |Central Region    |Bukit Timah   |\n|LIV @ MB                  |          3148740|   1453.14|           2167|01 Oct 2023 |114A ARTHUR ROAD #01-01     |New Sale     |Strata       |      135|          23324|-          |Condominium   |               1|99 yrs from 23/11/2021 |Uncompleted     |Private                     |439826      |15              |43            |Central Region    |Marine Parade |\n|MORI                      |          2422337|   1259.39|           1923|01 Oct 2023 |223 GUILLEMARD ROAD #05-21  |New Sale     |Strata       |      117|          20704|-          |Apartment     |               1|Freehold               |Uncompleted     |Private                     |399738      |14              |39            |Central Region    |Geylang       |\n|THE ARDEN                 |          1330000|    721.19|           1844|01 Oct 2023 |6 PHOENIX ROAD #01-18       |New Sale     |Strata       |       67|          19851|-          |Apartment     |               1|99 yrs from 14/07/2023 |Uncompleted     |Private                     |668159      |23              |66            |West Region       |Bukit Batok   |\n|LENTOR MODERN             |          2237000|   1130.22|           1979|01 Oct 2023 |3 LENTOR CENTRAL #05-03     |New Sale     |Strata       |      105|          21305|-          |Apartment     |               1|99 yrs from 26/10/2021 |Uncompleted     |Private                     |788888      |26              |78            |North East Region |Ang Mo Kio    |\n|THE LAKEGARDEN RESIDENCES |          1249900|    592.02|           2111|01 Oct 2023 |82 YUAN CHING ROAD #04-14   |New Sale     |Strata       |       55|          22725|-          |Condominium   |               1|99 yrs from 31/05/2023 |Uncompleted     |HDB                         |619614      |22              |61            |West Region       |Jurong East   |\n|LENTOR HILLS RESIDENCES   |          2890000|   1356.26|           2131|01 Oct 2023 |31 LENTOR HILLS ROAD #15-03 |New Sale     |Strata       |      126|          22937|-          |Apartment     |               1|99 yrs from 25/04/2022 |Uncompleted     |HDB                         |788881      |26              |78            |North East Region |Ang Mo Kio    |\n:::\n:::\n\n\nThere are **4,851** private residential property sales for 2023 Q4.\n\n### 2024 Q1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_2024q1 <- read_csv('data/ResidentialTransaction20240414220633.csv') %>%\n                  rename_with(rename_realis_column)\nkable(head(realis_2024q1, n=7))\n```\n\n::: {.cell-output-display}\n|PROJECT_NAME           | TRANSACTED_PRICE| AREA_SQFT| UNIT_PRICE_PSF|SALE_DATE   |ADDRESS                     |TYPE_OF_SALE |TYPE_OF_AREA | AREA_SQM| UNIT_PRICE_PSM|NETT_PRICE |PROPERTY_TYPE | NUMBER_OF_UNITS|TENURE                 |COMPLETION_DATE |PURCHASER_ADDRESS_INDICATOR |POSTAL_CODE |POSTAL_DISTRICT |POSTAL_SECTOR |PLANNING_REGION   |PLANNING_AREA |\n|:----------------------|----------------:|---------:|--------------:|:-----------|:---------------------------|:------------|:------------|--------:|--------------:|:----------|:-------------|---------------:|:----------------------|:---------------|:---------------------------|:-----------|:---------------|:-------------|:-----------------|:-------------|\n|THE LANDMARK           |          2726888|   1076.40|           2533|01 Jan 2024 |173 CHIN SWEE ROAD #22-11   |New Sale     |Strata       |      100|          27269|-          |Condominium   |               1|99 yrs from 28/08/2020 |Uncompleted     |Private                     |169878      |03              |16            |Central Region    |Outram        |\n|POLLEN COLLECTION      |          3850000|   1808.35|           2129|01 Jan 2024 |34 POLLEN PLACE             |New Sale     |Land         |      168|          22917|-          |Terrace House |               1|99 yrs from 09/12/2019 |Uncompleted     |N.A                         |807233      |28              |80            |North East Region |Serangoon     |\n|SKY EDEN@BEDOK         |          2346000|   1087.16|           2158|01 Jan 2024 |1 BEDOK CENTRAL #09-10      |New Sale     |Strata       |      101|          23228|-          |Apartment     |               1|99 yrs from 05/01/2022 |Uncompleted     |HDB                         |469657      |16              |46            |East Region       |Bedok         |\n|TERRA HILL             |          2190000|    807.30|           2713|01 Jan 2024 |18A YEW SIANG ROAD #03-12   |New Sale     |Strata       |       75|          29200|-          |Apartment     |               1|Freehold               |Uncompleted     |N.A                         |118992      |05              |11            |Central Region    |Queenstown    |\n|PINETREE HILL          |          1954000|    796.54|           2453|01 Jan 2024 |36 PINE GROVE #05-18        |New Sale     |Strata       |       74|          26405|-          |Condominium   |               1|99 yrs from 12/09/2022 |Uncompleted     |Private                     |598444      |21              |59            |Central Region    |Bukit Timah   |\n|THE RESERVE RESIDENCES |          3412201|   1323.97|           2577|01 Jan 2024 |13 JALAN ANAK BUKIT #28-106 |New Sale     |Strata       |      123|          27741|-          |Apartment     |               1|99 yrs from 29/11/2021 |Uncompleted     |Private                     |589605      |21              |58            |Central Region    |Bukit Timah   |\n|SUMMER VILLAS          |          2960000|   3530.59|            838|02 Jan 2024 |73 GERALD DRIVE #01-06      |Resale       |Strata       |      328|           9024|-          |Terrace House |               1|Freehold               |2004            |Private                     |797703      |28              |79            |North East Region |Hougang       |\n:::\n:::\n\n\nThere are **4,902** private residential property sales for 2024 Q1.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(realis_2023q1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 4,722\nColumns: 21\n$ PROJECT_NAME                <chr> \"THE REEF AT KING'S DOCK\", \"URBAN TREASURE…\n$ TRANSACTED_PRICE            <dbl> 2317000, 1823500, 1421112, 1258112, 128000…\n$ AREA_SQFT                   <dbl> 882.65, 882.65, 1076.40, 1033.34, 871.88, …\n$ UNIT_PRICE_PSF              <dbl> 2625, 2066, 1320, 1218, 1468, 1767, 1095, …\n$ SALE_DATE                   <chr> \"01 Jan 2023\", \"02 Jan 2023\", \"02 Jan 2023…\n$ ADDRESS                     <chr> \"12 HARBOURFRONT AVENUE #05-32\", \"205 JALA…\n$ TYPE_OF_SALE                <chr> \"New Sale\", \"New Sale\", \"New Sale\", \"New S…\n$ TYPE_OF_AREA                <chr> \"Strata\", \"Strata\", \"Strata\", \"Strata\", \"S…\n$ AREA_SQM                    <dbl> 82.0, 82.0, 100.0, 96.0, 81.0, 308.7, 420.…\n$ UNIT_PRICE_PSM              <dbl> 28256, 22238, 14211, 13105, 15802, 19015, …\n$ NETT_PRICE                  <chr> \"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-…\n$ PROPERTY_TYPE               <chr> \"Condominium\", \"Condominium\", \"Executive C…\n$ NUMBER_OF_UNITS             <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ TENURE                      <chr> \"99 yrs from 12/01/2021\", \"Freehold\", \"99 …\n$ COMPLETION_DATE             <chr> \"Uncompleted\", \"Uncompleted\", \"Uncompleted…\n$ PURCHASER_ADDRESS_INDICATOR <chr> \"HDB\", \"Private\", \"HDB\", \"HDB\", \"HDB\", \"Pr…\n$ POSTAL_CODE                 <chr> \"097996\", \"419535\", \"269343\", \"269294\", \"7…\n$ POSTAL_DISTRICT             <chr> \"04\", \"14\", \"27\", \"27\", \"28\", \"19\", \"10\", …\n$ POSTAL_SECTOR               <chr> \"09\", \"41\", \"26\", \"26\", \"79\", \"54\", \"27\", …\n$ PLANNING_REGION             <chr> \"Central Region\", \"East Region\", \"North Re…\n$ PLANNING_AREA               <chr> \"Bukit Merah\", \"Bedok\", \"Yishun\", \"Yishun\"…\n```\n:::\n:::\n\n\nThe imported dataset has 21 variables.\n\n## 3.2 Combining the dataframes\n\nNext, we will combine all 5 `realis_202*q*` dataframes into a single one to simplify aggregation and partitioning of data for analysis.\n\nThis will also simplify cleanup and transformation as they will be done on a single dataframe instead of 5.\n\nTo do this, we need to add `QUARTER` values to each dataframe before merging them to a single one. We will use the format `<YEAR>Q<QUARTER>`, i.e `2024Q1` for 2024 Q1. This is so we can identify which quarter the sale was made, which we will use for aggregation.\n\n::: {.callout-note appearance=\"simple\"}\n### Functions used\n\n-   `mutate()` for adding new column\n\n-   `rbind()` for combining all dataframes\n\n-   `seq_len()` and `nrow()` for generating a sequence of IDs\n\n-   `sprintf()` for formatting a string.\n:::\n\n::: panel-tabset\n### Adding QUARTER column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_2023q1 <- mutate(realis_2023q1, QUARTER=\"2023Q1\")\nrealis_2023q2 <- mutate(realis_2023q2, QUARTER=\"2023Q2\")\nrealis_2023q3 <- mutate(realis_2023q3, QUARTER=\"2023Q3\")\nrealis_2023q4 <- mutate(realis_2023q4, QUARTER=\"2023Q4\")\nrealis_2024q1 <- mutate(realis_2024q1, QUARTER=\"2024Q1\")\n```\n:::\n\n\n### Combining data frames\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis <- realis_2023q1 %>%\n  rbind(realis_2023q2) %>%\n  rbind(realis_2023q3) %>%\n  rbind(realis_2023q4) %>%\n  rbind(realis_2024q1)\nkable(head(realis, n=10))\n```\n\n::: {.cell-output-display}\n|PROJECT_NAME            | TRANSACTED_PRICE| AREA_SQFT| UNIT_PRICE_PSF|SALE_DATE   |ADDRESS                       |TYPE_OF_SALE |TYPE_OF_AREA | AREA_SQM| UNIT_PRICE_PSM|NETT_PRICE |PROPERTY_TYPE         | NUMBER_OF_UNITS|TENURE                  |COMPLETION_DATE |PURCHASER_ADDRESS_INDICATOR |POSTAL_CODE |POSTAL_DISTRICT |POSTAL_SECTOR |PLANNING_REGION   |PLANNING_AREA |QUARTER |\n|:-----------------------|----------------:|---------:|--------------:|:-----------|:-----------------------------|:------------|:------------|--------:|--------------:|:----------|:---------------------|---------------:|:-----------------------|:---------------|:---------------------------|:-----------|:---------------|:-------------|:-----------------|:-------------|:-------|\n|THE REEF AT KING'S DOCK |          2317000|    882.65|           2625|01 Jan 2023 |12 HARBOURFRONT AVENUE #05-32 |New Sale     |Strata       |     82.0|          28256|-          |Condominium           |               1|99 yrs from 12/01/2021  |Uncompleted     |HDB                         |097996      |04              |09            |Central Region    |Bukit Merah   |2023Q1  |\n|URBAN TREASURES         |          1823500|    882.65|           2066|02 Jan 2023 |205 JALAN EUNOS #08-02        |New Sale     |Strata       |     82.0|          22238|-          |Condominium           |               1|Freehold                |Uncompleted     |Private                     |419535      |14              |41            |East Region       |Bedok         |2023Q1  |\n|NORTH GAIA              |          1421112|   1076.40|           1320|02 Jan 2023 |29 YISHUN CLOSE #08-10        |New Sale     |Strata       |    100.0|          14211|-          |Executive Condominium |               1|99 yrs from 15/02/2021  |Uncompleted     |HDB                         |269343      |27              |26            |North Region      |Yishun        |2023Q1  |\n|NORTH GAIA              |          1258112|   1033.34|           1218|02 Jan 2023 |45 YISHUN CLOSE #07-42        |New Sale     |Strata       |     96.0|          13105|-          |Executive Condominium |               1|99 yrs from 15/02/2021  |Uncompleted     |HDB                         |269294      |27              |26            |North Region      |Yishun        |2023Q1  |\n|PARC BOTANNIA           |          1280000|    871.88|           1468|03 Jan 2023 |12 FERNVALE STREET #06-16     |Resale       |Strata       |     81.0|          15802|-          |Condominium           |               1|99 yrs from 28/12/2016  |2022            |HDB                         |797391      |28              |79            |North East Region |Sengkang      |2023Q1  |\n|NANYANG PARK            |          5870000|   3322.85|           1767|03 Jan 2023 |72 JALAN LIMBOK               |Resale       |Land         |    308.7|          19015|-          |Terrace House         |               1|999 yrs from 14/02/1881 |-               |Private                     |548742      |19              |54            |North East Region |Hougang       |2023Q1  |\n|PALMS @ SIXTH AVENUE    |          4950000|   4520.88|           1095|03 Jan 2023 |231 SIXTH AVENUE              |Resale       |Strata       |    420.0|          11786|-          |Semi-Detached House   |               1|Freehold                |2015            |Private                     |275780      |10              |27            |Central Region    |Bukit Timah   |2023Q1  |\n|N.A.                    |          3260000|   1555.40|           2096|03 Jan 2023 |19 TENG TONG ROAD             |Resale       |Land         |    144.5|          22561|-          |Terrace House         |               1|Freehold                |1941            |Private                     |423510      |15              |42            |Central Region    |Marine Parade |2023Q1  |\n|WHISTLER GRAND          |           850000|    441.32|           1926|03 Jan 2023 |107 WEST COAST VALE #30-04    |Sub Sale     |Strata       |     41.0|          20732|-          |Apartment             |               1|99 yrs from 07/05/2018  |2022            |HDB                         |126751      |05              |12            |West Region       |Clementi      |2023Q1  |\n|NORTHOAKS               |          1268000|   1603.84|            791|03 Jan 2023 |30 WOODLANDS CRESCENT #01-11  |Resale       |Strata       |    149.0|           8510|-          |Executive Condominium |               1|99 yrs from 16/12/1997  |2000            |HDB                         |738086      |25              |73            |North Region      |Woodlands     |2023Q1  |\n:::\n:::\n\n\n### Adding transaction ID's (TXN_ID)\n\nWe will also add `TXN_ID` so we can more easily refer to the observations later on. The format is `TXN00000`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis$TXN_ID <- sprintf(\"TXN%05d\", seq_len(nrow(realis)))\n```\n:::\n\n\n### Verifying the result\n\nLet us check if all rows are accounted for by checking if the number of rows in `realis` is the total number of rows from all dataframes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(realis) == nrow(realis_2023q1) +\n  nrow(realis_2023q2) +\n  nrow(realis_2023q3) +\n  nrow(realis_2023q4) +\n  nrow(realis_2024q1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n:::\n\n## 3.3 Filtering relevant columns\n\nAfter adding the `QUARTER` and `TXN_ID` columns, there are now 23 variables in the dataframe. However, not all of them are relevant to answer the questions we are asking. The table below summarizes the columns and whether we will keep them or not.\n\n::: panel-tabset\n### Column Details\n\n| Column Name                 | Description                                                                                                                                                                  | Action                      | Reason                                                            |\n|-----------------|-----------------------|-----------------|-----------------|\n| PROJECT_NAME                | Name of the project                                                                                                                                                          | [DROP]{style=\"color:red\"}   | Too specific for aggregation                                      |\n| TRANSACTED_PRICE            | Transaction price (SGD)                                                                                                                                                      | [KEEP]{style=\"color:green\"} | Core data for analysis                                            |\n| AREA_SQFT                   | Area of the property in sqft                                                                                                                                                 | [KEEP]{style=\"color:green\"} | Can be useful partitioning data                                   |\n| UNIT_PRICE_PSF              | Price per sqft                                                                                                                                                               | [KEEP]{style=\"color:green\"} | Can be useful for price analysis                                  |\n| SALE_DATE                   | Date when the sale was made                                                                                                                                                  | [DROP]{style=\"color:red\"}   | We will aggregate by quarter, no need to know the specific dates. |\n| ADDRESS                     | Property Address                                                                                                                                                             | [DROP]{style=\"color:red\"}   | Too specific for aggregation                                      |\n| TYPE_OF_SALE                | One of *New Sale*, *Resale*, *Subsale*                                                                                                                                       | [KEEP]{style=\"color:green\"} | Important submarket information                                   |\n| TYPE_OF_AREA                | One of *Landed*, *Strata*                                                                                                                                                    | [KEEP]{style=\"color:green\"} | Can be used to partition data                                     |\n| AREA_SQM                    | Price per sqm                                                                                                                                                                | [DROP]{style=\"color:red\"}   | AREA_SFT is adequate                                              |\n| UNIT_PRICE_PSM              | Price per sqm                                                                                                                                                                | [DROP]{style=\"color:red\"}   | UNIT_PRICE_PSF is adequate                                        |\n| NETT_PRICE                  |                                                                                                                                                                              | [DROP]{style=\"color:red\"}   | Column is blank                                                   |\n| PROPERTY_TYPE               | Type of Property, e.g. *Apartment, Condominium, Executive Condominium, Terrace House, Semi-Detached House, Detached House*                                                   | [KEEP]{style=\"color:green\"} | Can be used to partition data                                     |\n| NUMBER_OF_UNITS             | Number of units involved in the transaction                                                                                                                                  | [KEEP]{style=\"color:green\"} | Core data for analysis                                            |\n| TENURE                      | Can be Freehold or Leasehold                                                                                                                                                 | [KEEP]{style=\"color:green\"} | Can be used to partition data                                     |\n| COMPLETION_DATE             | When the property was completed. Some properties are Uncompleted as they will be turned over for the future                                                                  | [KEEP]{style=\"color:green\"} | Can be used to partition data                                     |\n| PURCHASER_ADDRESS_INDICATOR | [Type of residence of the purchaser](https://www.ura.gov.sg/reis/dataDictionary#:~:text=Purchaser%20Address%20Indicator%3A%20It%20refers,is%20owned%20by%20the%20purchaser.) | [KEEP]{style=\"color:green\"} | Can be used to partition data                                     |\n| POSTAL_CODE                 | Postal code of the property                                                                                                                                                  | [DROP]{style=\"color:red\"}   | Too specific for aggregation                                      |\n| POSTAL_DISTRICT             | District where the property is located                                                                                                                                       | [KEEP]{style=\"color:green\"} | Can be used to partition data                                     |\n| POSTAL_SECTOR               | Sector where the property is located                                                                                                                                         | [DROP]{style=\"color:red\"}   | Irrelevant                                                        |\n| PLANNING_REGION             | Region where the property is located                                                                                                                                         | [KEEP]{style=\"color:green\"} | Can be used to partition data                                     |\n| PLANNING_AREA               | Area where the property is located                                                                                                                                           | [KEEP]{style=\"color:green\"} | Can be used to partition data                                     |\n| QUARTER                     | Quarter where the property was sold                                                                                                                                          | [KEEP]{style=\"color:green\"} | Core data for aggregation                                         |\n| TXN_ID                      | Identifier for the transaction                                                                                                                                               | [KEEP]{style=\"color:green\"} | It is an identifier                                               |\n\n### Filter code\n\nWe will now use `select()` to keep only the relevant columns. We will define the function below for filtering the relevant columns. This will also rearrange the columns based on the order in the function call.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis <-\n  realis %>% select(\n    c(\n      TXN_ID,\n      PROJECT_NAME,\n      QUARTER,\n      NUMBER_OF_UNITS,\n      TRANSACTED_PRICE,\n      AREA_SQFT,\n      TYPE_OF_SALE,\n      PROPERTY_TYPE,\n      TYPE_OF_AREA,\n      POSTAL_DISTRICT,\n      PLANNING_REGION,\n      PLANNING_AREA,\n      TENURE,\n      UNIT_PRICE_PSF,\n      COMPLETION_DATE,\n      PURCHASER_ADDRESS_INDICATOR\n    )\n  )\n```\n:::\n\n:::\n\nAfter this initial cleanup, we are left with 15 variables relevant to our exploration.\n\n::: {.callout-tip collapse=\"true\"}\n### Save point\n\nLet us save `realis` so we do not need to rerun the steps above.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(realis, \"data/rds/realis_after_clean.rds\")\n```\n:::\n\n:::\n\n::: {.callout-warning collapse=\"true\"}\n### Data clear point\n\nWe do not need the `realis_202*q*` dataframes anymore so we can remove them from the RStudio environment.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(realis_2023q1)\nrm(realis_2023q2)\nrm(realis_2023q3)\nrm(realis_2023q4)\nrm(realis_2024q1)\n```\n:::\n\n:::\n\n## 3.4 Closer look at NUMBER_OF_UNITS\n\n::: {.callout-note collapse=\"true\"}\n### Load point\n\nWe can continue running the document from this point by loading the following prepared data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis <- read_rds(\"data/rds/realis_after_clean.rds\")\n```\n:::\n\n:::\n\nTaking a closer look at `NUMBER_OF_UNITS` columns reveals that **12 out of 26,806 transactions** involve multiple units.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis[order(-realis$NUMBER_OF_UNITS),] %>% filter(NUMBER_OF_UNITS > 1) %>% kable()\n```\n\n::: {.cell-output-display}\n|TXN_ID   |PROJECT_NAME           |QUARTER | NUMBER_OF_UNITS| TRANSACTED_PRICE| AREA_SQFT|TYPE_OF_SALE |PROPERTY_TYPE       |TYPE_OF_AREA |POSTAL_DISTRICT |PLANNING_REGION   |PLANNING_AREA |TENURE   | UNIT_PRICE_PSF|COMPLETION_DATE |PURCHASER_ADDRESS_INDICATOR |\n|:--------|:----------------------|:-------|---------------:|----------------:|---------:|:------------|:-------------------|:------------|:---------------|:-----------------|:-------------|:--------|--------------:|:---------------|:---------------------------|\n|TXN01567 |MEYER PARK             |2023Q1  |              60|        392180000| 144883.44|Resale       |Condominium         |Strata       |15              |Central Region    |Marine Parade |Freehold |           2707|1985            |Private                     |\n|TXN00083 |BAGNALL COURT          |2023Q1  |              43|        115280000|  68491.33|Resale       |Condominium         |Strata       |16              |East Region       |Bedok         |Freehold |           1683|1991            |Private                     |\n|TXN08370 |KEW LODGE              |2023Q2  |              11|         66800000|  25177.00|Resale       |Terrace House       |Strata       |11              |Central Region    |Novena        |Freehold |           2653|1984            |Private                     |\n|TXN17572 |KARTAR APARTMENTS      |2023Q4  |               7|         18000000|   6964.31|Resale       |Apartment           |Strata       |11              |Central Region    |Novena        |Freehold |           2585|-               |Private                     |\n|TXN00861 |MONDO MANSION BUILDING |2023Q1  |               4|          6280000|   5489.64|Resale       |Apartment           |Strata       |19              |North East Region |Serangoon     |Freehold |           1144|1976            |Private                     |\n|TXN10593 |N.A.                   |2023Q2  |               4|         10600000|   6746.88|Resale       |Apartment           |Strata       |15              |East Region       |Bedok         |Freehold |           1571|1985            |Private                     |\n|TXN04100 |N.A.                   |2023Q1  |               3|         61080008|  32148.84|Resale       |Detached House      |Land         |11              |Central Region    |Novena        |Freehold |           1900|-               |Private                     |\n|TXN06865 |N.A.                   |2023Q2  |               2|         32200000|  14123.44|Resale       |Detached House      |Land         |11              |Central Region    |Novena        |Freehold |           2280|1997            |Private                     |\n|TXN10316 |N.A.                   |2023Q2  |               2|          6150000|   4342.20|Resale       |Semi-Detached House |Land         |19              |North East Region |Serangoon     |Freehold |           1416|-               |Private                     |\n|TXN12792 |EAST VIEW GARDEN       |2023Q3  |               2|          6100000|   8337.79|Resale       |Semi-Detached House |Land         |16              |East Region       |Tampines      |Freehold |            732|-               |Private                     |\n|TXN13376 |N.A.                   |2023Q3  |               2|          8000000|   3658.68|Resale       |Semi-Detached House |Land         |14              |Central Region    |Geylang       |Freehold |           2187|-               |Private                     |\n|TXN24770 |CLAYMORE PLAZA         |2024Q1  |               2|          7000000|   4208.72|Resale       |Apartment           |Strata       |09              |Central Region    |Orchard       |Freehold |           1663|1983            |Private                     |\n:::\n:::\n\n\nFurthermore, the `TRANSACTED_PRICE` for such transactions are **hundred million dollar transactions**, which can skew the data if we are looking at `TRANSACTED_PRICE` with the assumption that it is the **price per unit**.\n\nFor example **TXN01567**, is worth **\\$392,180,000**, which is much higher that the price of individual units\n\n## 3.5 Handling the bulk transactions\n\nTo address the 12 bulk transactions in our dataframe, we have 2 possible options:\n\n-   **Option 1**: Remove these transactions as these correspond to **0.045%** of transactions ([**EASY**]{style=\"color:green\"})\n\n-   **Option 2**: Create rows for each unit in the transaction ([**HARD**]{style=\"color:red\"})\n\nAlthough Option 2 is more difficult, it is the better approach as all the transactions are **Resale** transactions. Simply removing them may remove very important data for the resale submarket.\n\nFor this solution, we need to do the following:\n\n1.  Repeat all rows by `NUMBER_OF_UNITS` times.\n2.  Set transacted price to the average price: $\\frac{TRANSACTED\\_PRICE}{NUMBER\\_OF\\_UNITS}$.\n3.  Set the area (sqft) to the average area: $\\frac{AREA\\_SQFT}{NUMBER\\_OF\\_UNITS}$.\n4.  Set `NUMBER_OF_UNITS` to 1.\n\n::: panel-tabset\n### Repeating rows\n\nReference: [Stackoverflow](https://stackoverflow.com/questions/11121385/repeat-rows-of-a-data-frame)\n\n::: {.callout-note appearance=\"simple\"}\n#### Functions used\n\n`rep()` - to repeat a dataframe\n\n`seq_len(nrow())` - to iterate to each row of the dataframe\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_per_unit <- realis[rep(seq_len(nrow(realis)), realis$NUMBER_OF_UNITS),]\n```\n:::\n\n\nLets' check if the number of rows correspond to the total number of units sold.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnrow(realis_per_unit) == sum(realis$NUMBER_OF_UNITS)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n\n### Setting column values\n\nWe will perform the changes to `NUMBER_OF_UNITS`, `TRANSACTED_PRICE`, `AREA_SQFT` in 1 code chunk so that rerunning the code chunk is idempotent and won't mutate the variable further\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_per_unit <- realis_per_unit %>%\n  filter(NUMBER_OF_UNITS > 1) %>%\n  mutate(TRANSACTED_PRICE = round(TRANSACTED_PRICE / NUMBER_OF_UNITS, 0)) %>%\n  mutate(AREA_SQFT = round(AREA_SQFT / NUMBER_OF_UNITS, 0)) %>%\n  mutate(NUMBER_OF_UNITS = 1) %>%\n  rbind(realis_per_unit %>% # Reconnect to the rest of the dataframe\n              filter(NUMBER_OF_UNITS == 1))\n```\n:::\n\n:::\n\nLet us verify the result of the transformation.\n\n::: panel-tabset\n### Before\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis %>%\n  filter(TXN_ID %in% c(\n    \"TXN00001\", \"TXN00002\", # Single-unit transactions\n    \"TXN10593\", \"TXN13376\" # Bulk transactions\n    )) %>% kable()\n```\n\n::: {.cell-output-display}\n|TXN_ID   |PROJECT_NAME            |QUARTER | NUMBER_OF_UNITS| TRANSACTED_PRICE| AREA_SQFT|TYPE_OF_SALE |PROPERTY_TYPE       |TYPE_OF_AREA |POSTAL_DISTRICT |PLANNING_REGION |PLANNING_AREA |TENURE                 | UNIT_PRICE_PSF|COMPLETION_DATE |PURCHASER_ADDRESS_INDICATOR |\n|:--------|:-----------------------|:-------|---------------:|----------------:|---------:|:------------|:-------------------|:------------|:---------------|:---------------|:-------------|:----------------------|--------------:|:---------------|:---------------------------|\n|TXN00001 |THE REEF AT KING'S DOCK |2023Q1  |               1|          2317000|    882.65|New Sale     |Condominium         |Strata       |04              |Central Region  |Bukit Merah   |99 yrs from 12/01/2021 |           2625|Uncompleted     |HDB                         |\n|TXN00002 |URBAN TREASURES         |2023Q1  |               1|          1823500|    882.65|New Sale     |Condominium         |Strata       |14              |East Region     |Bedok         |Freehold               |           2066|Uncompleted     |Private                     |\n|TXN10593 |N.A.                    |2023Q2  |               4|         10600000|   6746.88|Resale       |Apartment           |Strata       |15              |East Region     |Bedok         |Freehold               |           1571|1985            |Private                     |\n|TXN13376 |N.A.                    |2023Q3  |               2|          8000000|   3658.68|Resale       |Semi-Detached House |Land         |14              |Central Region  |Geylang       |Freehold               |           2187|-               |Private                     |\n:::\n:::\n\n\n### After\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_per_unit %>%\n  filter(TXN_ID %in% c(\n    \"TXN00001\", \"TXN00002\", # Single-unit transactions\n    \"TXN10593\", \"TXN13376\" # Bulk transactions\n    )) %>% kable()\n```\n\n::: {.cell-output-display}\n|TXN_ID   |PROJECT_NAME            |QUARTER | NUMBER_OF_UNITS| TRANSACTED_PRICE| AREA_SQFT|TYPE_OF_SALE |PROPERTY_TYPE       |TYPE_OF_AREA |POSTAL_DISTRICT |PLANNING_REGION |PLANNING_AREA |TENURE                 | UNIT_PRICE_PSF|COMPLETION_DATE |PURCHASER_ADDRESS_INDICATOR |\n|:--------|:-----------------------|:-------|---------------:|----------------:|---------:|:------------|:-------------------|:------------|:---------------|:---------------|:-------------|:----------------------|--------------:|:---------------|:---------------------------|\n|TXN10593 |N.A.                    |2023Q2  |               1|          2650000|   1687.00|Resale       |Apartment           |Strata       |15              |East Region     |Bedok         |Freehold               |           1571|1985            |Private                     |\n|TXN10593 |N.A.                    |2023Q2  |               1|          2650000|   1687.00|Resale       |Apartment           |Strata       |15              |East Region     |Bedok         |Freehold               |           1571|1985            |Private                     |\n|TXN10593 |N.A.                    |2023Q2  |               1|          2650000|   1687.00|Resale       |Apartment           |Strata       |15              |East Region     |Bedok         |Freehold               |           1571|1985            |Private                     |\n|TXN10593 |N.A.                    |2023Q2  |               1|          2650000|   1687.00|Resale       |Apartment           |Strata       |15              |East Region     |Bedok         |Freehold               |           1571|1985            |Private                     |\n|TXN13376 |N.A.                    |2023Q3  |               1|          4000000|   1829.00|Resale       |Semi-Detached House |Land         |14              |Central Region  |Geylang       |Freehold               |           2187|-               |Private                     |\n|TXN13376 |N.A.                    |2023Q3  |               1|          4000000|   1829.00|Resale       |Semi-Detached House |Land         |14              |Central Region  |Geylang       |Freehold               |           2187|-               |Private                     |\n|TXN00001 |THE REEF AT KING'S DOCK |2023Q1  |               1|          2317000|    882.65|New Sale     |Condominium         |Strata       |04              |Central Region  |Bukit Merah   |99 yrs from 12/01/2021 |           2625|Uncompleted     |HDB                         |\n|TXN00002 |URBAN TREASURES         |2023Q1  |               1|          1823500|    882.65|New Sale     |Condominium         |Strata       |14              |East Region     |Bedok         |Freehold               |           2066|Uncompleted     |Private                     |\n:::\n:::\n\n:::\n\n::: {.callout-tip collapse=\"true\"}\n### Save point\n\nLet us save `realis_per_unit` so we do not need to rerun the steps above.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(realis_per_unit, \"data/rds/realis_per_unit.rds\")\n```\n:::\n\n:::\n\n# 4 Data Exploration\n\nFor this exercise, we will focus on exploring and visualizing the **distribution among the different submarkets**.\n\nThe points of interest are:\n\n-   2023 and 2024 Q1 prices\n\n-   Trends in sales volume per quarter\n\n-   Distribution across different markets within 2024Q1\n\n## 4.1 Comparing 2023Q1 and 2024Q1 prices\n\nFirst we will compare the prices between the **First Quarter** of 2023 and 2024. This is to compare the prices at the same time of the year.\n\nFor this visualization, we will use the **Unit Price per Sqft** (`UNIT_PRICE_PSF`) instead of the **Transaction Price** (`TRANSACTED_PRICE`). This is so we can more fairly compare prices with less variables involved. With Transaction Price, the size of the property needs to be considered.\n\nWe will use the `TYPE_OF_SALE` column to partition the data so we can compare the trends across the **Resale, New Sale and Sub Sale markets**.\n\n### 4.1.2 Creating the base Visualization\n\nFor the visualization, we will use a **Raincloud Plot** so that we can see the patterns in the price trends, and whether there are clusters of interest within the data set.\n\nWe will also add a **boxplot** to accompany the half-density plot so that we can see the quantiles more clearly.\n\nTo compare the different quarters, we will use both **left side and right side** visualization to compare the quarters side by side. This is inspired by a [senior's work.](https://akalestale.netlify.app/take-home_ex/take-home_ex01/take-home_ex01)\n\nTo visualize the volumes, the 2 options are using `stat_dots()` or `geom_jitter()`.\n\n::: panel-tabset\n#### Raincloud Plot w/ volume plot (chosen)\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show ggplot2 code\"}\nplot_q1_yoy_psf_price <- function() {\n  ggplot(\n    realis_per_unit %>% filter(QUARTER %in% c(\"2023Q1\", \"2024Q1\")),\n    aes(\n      x = QUARTER,\n      y = UNIT_PRICE_PSF,\n      fill = QUARTER,\n      color = QUARTER\n    )\n  ) +\n    \n    # Generate half-density plot\n    stat_halfeye(\n      aes(\n        justification = ifelse(QUARTER == \"2023Q1\", 1.20, 0.02),\n        side = ifelse(QUARTER == \"2023Q1\", \"left\", \"right\")\n      ),\n      position = position_nudge(x = 0.1, y = 0),\n      .width = 0,\n      alpha = 0.8,\n      point_color = NA,\n      show.legend = FALSE\n    ) +\n    \n    # Generate boxplot along edge of half-density plot\n    geom_boxplot(\n      outlier.shape = NA,\n      alpha = 0.8,\n      width = .1,\n      color = \"black\",\n      show.legend = FALSE\n    ) +\n    \n    # Generate volume plots, adjusting sizing so as to not overflow into the other half\n    stat_dots(\n      aes(\n        side = ifelse(QUARTER == \"2024Q1\", \"left\", \"right\"),\n        justification = ifelse(QUARTER == \"2024Q1\", 1.10,-0.1)\n      ),\n      binwidth = 100,\n      dotsize = 0.005,\n      alpha = 0.2,\n      show.legend = FALSE\n    ) +\n    \n    # Add text about the median price\n    stat_summary(\n      aes(label = paste0(\"S$\", after_stat(y))),\n      geom = \"text\",\n      fun = \"median\",\n      position = position_nudge(y = 2500),\n      family = \"Roboto Condensed\",\n      show.legend = FALSE\n    ) +\n    \n    # Set colors and fill\n    # Keep it simple, and use bright color for 20424Q1 it is the focus of visualization\n    scale_color_manual(values = c(\"grey45\", \"blue\")) +\n    scale_fill_manual(values = c(\"grey45\", \"blue\")) +\n    labs(y = \"Unit Price Per Sqft ($)\") +\n    # Next steps will take care of theme enhancements\n    theme_minimal()\n}\n\nplot_q1_yoy_psf_price()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n#### Raincloud Plot w/ jitter plot (alternative)\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show ggplot2 code\"}\nplot_q1_yoy_psf_price_alt <- function() {\n  ggplot(\n    realis_per_unit %>% filter(QUARTER %in% c(\"2023Q1\", \"2024Q1\")),\n    aes(\n      x = QUARTER,\n      y = UNIT_PRICE_PSF,\n      fill = QUARTER,\n      color = QUARTER\n    )\n  ) +\n    \n    # Generate half-density plot\n    stat_halfeye(\n      aes(\n        fill = QUARTER,\n        justification = ifelse(QUARTER == \"2023Q1\", 1.22, 0),\n        side = ifelse(QUARTER == \"2023Q1\", \"left\", \"right\")\n      ),\n      position = position_nudge(x = 0.1, y = 0),\n      .width = 0,\n      alpha = 0.8,\n      point_color = NA,\n      show.legend = FALSE\n    ) +\n    \n    # Generate jitter plot under the geom plot so the dots don't overpower the boxplot\n    geom_jitter(\n      width = 0.08,\n      size = 0.01,\n      alpha = 0.2,\n      show.legend = FALSE\n    ) +\n    \n    # Generate boxplot along edge of half-density plot\n    geom_boxplot(\n      outlier.shape = NA,\n      alpha = 0,\n      width = 0.1,\n      color = \"black\",\n      show.legend = FALSE\n    ) +\n    \n    # Add text about the median price\n    stat_summary(\n      aes(label = paste0(\"S$\", after_stat(y))),\n      geom = \"text\",\n      fun = \"median\",\n      position = position_nudge(y = 2500),\n      family = \"Roboto Condensed\",\n      show.legend = FALSE\n    )+\n    \n    # Set colors and fill\n    # Keep it simple, and use bright color for 20424Q1 it is the focus of visualization\n    scale_fill_manual(values = c(\"grey50\", \"blue\")) +\n    scale_color_manual(values = c(\"grey50\", \"blue\")) +\n    labs(y = \"Unit Price Per Sqft ($)\") +\n    # Next steps will take care of theme enhancements\n    theme_minimal()\n}\n\nplot_q1_yoy_psf_price_alt()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n:::\n\n::: callout-important\n#### Winner: stat_dots()\n\nUsing `stat_dots()` is better than `geom_jitter()` as the purpose of providing volume information here is to **accompany the half-density plot** and provide a tool to compare the volume of each submarket.\n\nComparing the length of each horizontal line is much easier to do than comparing how dark each area is in a jitter plot.\n:::\n\nNow that we have the base visualization, we will generate the final visualization.\n\n### 4.1.2 Generating the visualization\n\nWe want to compare the 2023 and 2024 Q1 sales for different submarkets. To do this, we will use `facet_wrap()` on `TYPE_OF_SALE`.\n\nIn addition, we will add another facet for **All Markets** for the overall comparison.\n\nThese 2 plots will be shown side by side using `patchwork`.\n\n::: {.callout-note appearance=\"simple\"}\n#### facet_grid(margin = TRUE) as alternative\n\nWe can also use `facet_grid(margin = TRUE)` to generate a facet with all the data, instead of generating 2 separate plots.\n\nHowever, I would like to change the panel color for the overall plot to highlight it but I couldn't find a way to do it within `facet_grid()`.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show ggplot2 code\"}\nq1_yoy_psf_price_submarkets_graph <- plot_q1_yoy_psf_price() +\n  facet_wrap(~ TYPE_OF_SALE,\n             strip.position = \"bottom\",\n             labeller = labeller(\n               TYPE_OF_SALE = c(\n                 \"New Sale\" = \"New Sale (<span style='color:brown;'>**-7.6%**</span>)\",\n                 \"Sub Sale\" = \"Sub Sale (<span style='color:brown;'>**-0.5%**</span>)\",\n                 \"Resale\" = \"Resale (<span style='color:darkgreen;'>**+3.3%**</span>)\"\n               )\n             )) +\n  theme_minimal() +\n  theme(axis.title.y = element_blank(),\n        axis.text.y = element_blank())\n\nq1_yoy_psf_price_all_markets_graph <- plot_q1_yoy_psf_price() +\n  facet_wrap(~ NUMBER_OF_UNITS,\n             strip.position = \"bottom\",\n             labeller = as_labeller(function(l) {\n               \"All Markets (<span style='color:darkgreen;'>**+1.7%**</span>)\"\n             })) +\n  labs(x = \"Transaction Price (,000 SGD)\") +\n  theme(panel.background = element_rect(fill = \"aliceblue\", linewidth =\n                                          0))\n\nviz1 <- (q1_yoy_psf_price_all_markets_graph |\n           q1_yoy_psf_price_submarkets_graph) +\n  plot_layout(widths = c(1, 3)) +\n  plot_annotation(title = \"Singapore Private Property Prices by Sales Market\",\n                  subtitle = \"Overall prices slightly increased by <span style='color:darkgreen;'>**1.7%**</span> but the New Sales market experienced <span style='color:brown;'>**7.6%**</span> decrease.\") &\n  theme(\n    text = element_text(family = \"Roboto Condensed\"),\n    axis.line.x = element_line(),\n    axis.title.x = element_blank(),\n    axis.ticks.y = element_blank(),\n    plot.title = element_text(face = \"bold\"),\n    plot.subtitle = element_markdown(color = \"grey50\", size = rel(0.9)),\n    strip.placement = \"outside\",\n    strip.text = element_markdown(size = rel(1))\n  )\nviz1\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n::: callout-tip\n#### Insights\n\nAlthough there is an overall slight increase in market unit prices compared to Q1 2023, the **New Sale** market experienced a decrease, with notable groups in the graph. This indicates cluster of sales in certain price points, which may be influenced by factors such as **developer pricing** and **location of New Launches.**\n\nThe New Sales Market is composed of **New Launch** properties. Groups are expected to appear in the density map as new projects are expected in new estates, while less projects are expected in mature estates. According to [99.co](https://www.99.co/singapore/new-launches), there are **less than 10 New Launches** in 2024. Prices are set by the developers so there is **less variation in unit price within each project**. Hence, it is expected to see groups around these New Launches. This effect is also observed to a smaller extent in the Sub Sale Market.\n\nIn the Resale Market, the available market is **all properties that have already been turned over by developers**. Price is set based on agreement between the buyer and seller, and is not limited to certain projects. Hence, there is more variation in the prices, which is why the distribution appears smoother.\n:::\n\nHowever, it is important to note that visualization can be very **misleading** especially on the New Sale Market. Generalizing that the trends when there are notable cluster may not be representative of the real state of the market.\n\nHence, we need to look more deeply into these groups and present it as a visualizations so it can be better understood why there are groups that formed.\n\n## 4.2 Comparing 2023Q1 and 2024Q1 Sales Volume\n\n### 4.2.1 Understanding the groups in New Sales Market\n\nWe hypothesized that the groups that are present in the **New Sales** plot is due to the sales of **newly-launched projects**.\n\nWe will check the aggregated data by `PROJECT_NAME` and `POSTAL_DISTRICT` to verify our hypothesis that the sales are clustered by newly launched projects and their respective districts\n\n::: panel-tabset\n#### By Project Name\n\nWe will aggregate the **number of sales** and **median unit price** by projects. We will also add `POSTAL_DISTRICT` to the aggregation group as property prices depend on which district a property is in.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_per_unit %>% filter(TYPE_OF_SALE == \"New Sale\", QUARTER == \"2024Q1\") %>% \n  group_by(POSTAL_DISTRICT, PROJECT_NAME) %>%\n  summarize(\n    MEDIAN_PRICE_PSF = median(UNIT_PRICE_PSF),\n    NUMBER_OF_SALES = n()\n  ) %>%\n  arrange(desc(NUMBER_OF_SALES)) %>%\n  head(10) %>% kable(row.name = TRUE)\n```\n\n::: {.cell-output-display}\n|   |POSTAL_DISTRICT |PROJECT_NAME             | MEDIAN_PRICE_PSF| NUMBER_OF_SALES|\n|:--|:---------------|:------------------------|----------------:|---------------:|\n|1  |26              |LENTOR MANSION           |           2269.0|             409|\n|2  |23              |LUMINA GRAND             |           1525.0|             370|\n|3  |23              |HILLHAVEN                |           2067.0|              79|\n|4  |26              |LENTORIA                 |           2129.0|              60|\n|5  |23              |THE BOTANY AT DAIRY FARM |           2019.0|              59|\n|6  |27              |NORTH GAIA               |           1326.5|              54|\n|7  |12              |THE ARCADY AT BOON KENG  |           2573.5|              50|\n|8  |26              |LENTOR HILLS RESIDENCES  |           2109.0|              49|\n|9  |26              |HILLOCK GREEN            |           2169.0|              43|\n|10 |23              |THE MYST                 |           2160.5|              42|\n:::\n:::\n\n\nWe can see that **8 out of 10** projects with highest number of sales are in **Districts 23 and 26.** This is consistent with our previous observation that there are 2 groups in the New Sales density graph.\n\nFurthermore, in [99.co's New Launches page](https://www.99.co/singapore/new-launches), [Lentor Mansion](https://www.99.co/singapore/condos-apartments/lentor-mansion) (D26) and [Lumina Grand](https://www.99.co/singapore/condos-apartments/lumina-grand) (D23) are the biggest projects with the highest number of units sold.\n\nHence, the density graph could reflected the groups that formed from the sales of properties within these 2 projects.\n\n#### By District\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrealis_per_unit %>% filter(TYPE_OF_SALE == \"New Sale\", QUARTER == \"2024Q1\") %>% \n  group_by(POSTAL_DISTRICT) %>%\n  summarize(\n    MEDIAN_PRICE_PSF = median(UNIT_PRICE_PSF),\n    NUMBER_OF_SALES = n()\n  ) %>%\n  arrange(desc(NUMBER_OF_SALES)) %>%\n  kable(row.names = TRUE)\n```\n\n::: {.cell-output-display}\n|   |POSTAL_DISTRICT | MEDIAN_PRICE_PSF| NUMBER_OF_SALES|\n|:--|:---------------|----------------:|---------------:|\n|1  |23              |           1542.0|             576|\n|2  |26              |           2253.0|             571|\n|3  |15              |           2615.5|              72|\n|4  |21              |           2453.0|              57|\n|5  |27              |           1328.0|              56|\n|6  |12              |           2573.0|              51|\n|7  |11              |           3189.0|              40|\n|8  |10              |           3307.0|              37|\n|9  |03              |           2807.0|              31|\n|10 |05              |           2607.5|              20|\n|11 |28              |           2254.0|              20|\n|12 |16              |           2091.0|              19|\n|13 |22              |           2215.0|              17|\n|14 |09              |           3437.5|              14|\n|15 |02              |           2567.0|              13|\n|16 |07              |           3234.0|               8|\n|17 |19              |           1966.0|               7|\n|18 |14              |           2168.0|               5|\n|19 |18              |           1754.0|               3|\n|20 |04              |           2548.5|               2|\n|21 |17              |           1895.0|               2|\n:::\n:::\n\n\nAlthough there are new units across all districts, the big, newly launched projects contributed the most to the New Sales Market.\n\nThis is hinted by the fact that after aggregating all property sales by district, D23 and D26 where [Lumina Grand](https://www.99.co/singapore/condos-apartments/lumina-grand) and [Lentor Mansion](https://www.99.co/singapore/condos-apartments/lentor-mansion) stand out. More than 60% of sales from each of these district also come from these 2 projects.\n:::\n\nBased on the findings from this deep dive, we will visualize the sales volume by district.\n\n### 4.2.2. Creating the base visualization\n\nSome of the options we have to visualize the sales by district are:\n\n-   Bar graph of number of sales for **all** district, or\n\n-   Bar graph of number of sales for **most popular** districts\n\n::: panel-tabset\n#### All districts\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_q1_yoy_sale_vol <- function() {\nggplot(\n  realis_per_unit %>% filter(QUARTER %in% c(\"2023Q1\", \"2024Q1\")),\n  aes(x = POSTAL_DISTRICT, fill = QUARTER)\n) +\n  geom_bar(position=\"dodge\", show.legend = FALSE) +\n  coord_flip() +\n  scale_fill_manual(values = c(\"grey45\", \"blue\")) +\n  theme_minimal()\n}\n\nplot_q1_yoy_sale_vol()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n#### Most popular districts (chosen)\n\nThis visualization needs some pre-processing so we can determine the Top 5 most popular districts in each submarket.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopular_districts <- realis_per_unit %>% filter(QUARTER %in% c(\"2023Q1\", \"2024Q1\")) %>% \n  group_by(QUARTER, POSTAL_DISTRICT, TYPE_OF_SALE) %>%\n  summarize(\n    MEDIAN_PRICE_PSF = median(UNIT_PRICE_PSF),\n    NUMBER_OF_SALES = n()\n  ) %>%\n  group_by(QUARTER, TYPE_OF_SALE) %>%\n  arrange(desc(NUMBER_OF_SALES)) %>%\n  mutate(RANK = order(NUMBER_OF_SALES, decreasing=TRUE)) %>%\n  filter(RANK <= 5) %>%\n  select(c(QUARTER, TYPE_OF_SALE, RANK, POSTAL_DISTRICT, NUMBER_OF_SALES, MEDIAN_PRICE_PSF)) %>%\n  arrange(QUARTER)\n\nkable(popular_districts, row.names = TRUE)\n```\n\n::: {.cell-output-display}\n|   |QUARTER |TYPE_OF_SALE | RANK|POSTAL_DISTRICT | NUMBER_OF_SALES| MEDIAN_PRICE_PSF|\n|:--|:-------|:------------|----:|:---------------|---------------:|----------------:|\n|1  |2023Q1  |Resale       |    1|19              |             401|           1337.0|\n|2  |2023Q1  |Resale       |    2|15              |             260|           1830.0|\n|3  |2023Q1  |Resale       |    3|10              |             251|           2162.0|\n|4  |2023Q1  |Resale       |    4|16              |             210|           1410.5|\n|5  |2023Q1  |Resale       |    5|23              |             208|           1258.5|\n|6  |2023Q1  |New Sale     |    1|10              |             202|           2942.5|\n|7  |2023Q1  |New Sale     |    2|23              |             178|           2071.5|\n|8  |2023Q1  |New Sale     |    3|18              |             168|           1390.0|\n|9  |2023Q1  |New Sale     |    4|16              |             165|           2084.0|\n|10 |2023Q1  |New Sale     |    5|09              |             150|           2846.0|\n|11 |2023Q1  |Sub Sale     |    1|19              |              54|           1635.5|\n|12 |2023Q1  |Sub Sale     |    2|14              |              34|           2096.5|\n|13 |2023Q1  |Sub Sale     |    3|13              |              27|           1913.0|\n|14 |2023Q1  |Sub Sale     |    4|18              |              24|           1598.0|\n|15 |2023Q1  |Sub Sale     |    5|05              |              19|           1912.0|\n|16 |2024Q1  |New Sale     |    1|23              |             576|           1542.0|\n|17 |2024Q1  |New Sale     |    2|26              |             571|           2253.0|\n|18 |2024Q1  |Resale       |    1|19              |             429|           1448.0|\n|19 |2024Q1  |Resale       |    2|15              |             243|           1719.0|\n|20 |2024Q1  |Resale       |    3|10              |             236|           2171.5|\n|21 |2024Q1  |Resale       |    4|23              |             209|           1361.0|\n|22 |2024Q1  |Resale       |    5|18              |             182|           1350.0|\n|23 |2024Q1  |Sub Sale     |    1|19              |              94|           1771.5|\n|24 |2024Q1  |New Sale     |    3|15              |              72|           2615.5|\n|25 |2024Q1  |New Sale     |    4|21              |              57|           2453.0|\n|26 |2024Q1  |New Sale     |    5|27              |              56|           1328.0|\n|27 |2024Q1  |Sub Sale     |    2|05              |              53|           2061.0|\n|28 |2024Q1  |Sub Sale     |    3|18              |              49|           1694.0|\n|29 |2024Q1  |Sub Sale     |    4|13              |              20|           2044.0|\n|30 |2024Q1  |Sub Sale     |    5|14              |              14|           2051.5|\n:::\n:::\n\n\nNow that we have this aggregated dataset, we can use this to plot the ranked data. For example, we can plot the most popular districts in the New Sales Market.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(popular_districts %>% filter(TYPE_OF_SALE ==\"New Sale\"),\n       aes(x = reorder(RANK, -RANK), y = NUMBER_OF_SALES, fill = QUARTER))+\n  geom_bar(stat=\"identity\", position = \"dodge\", show.legend = FALSE, alpha =0.8) +\n  geom_text(aes(y = 10, hjust=0, label=paste0(\"D\", POSTAL_DISTRICT, \": \", NUMBER_OF_SALES))) +\n  coord_flip(ylim= c(0, 600)) +\n  scale_fill_manual(values = c(\"grey45\", \"blue\")) +\n  facet_wrap(~QUARTER)\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\nWith this visualization, we can compare the top districts from 2 quarters side by side.\n:::\n\nFrom the 2 options, plotting the **Most Popular Districts** is more appropriate for our use case. This is because we would like the user to recognize which districts are driving the price trends.\n\nWhen we plot all the districts, it is more difficult to identify by sight which districts are popular in a quarter and the other. This is because this plot has a lot of noise, which may not be that relevant to connect to the previous visualization.\n\n### 4.2.3 Generating the visualization\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show ggplot2 code\"}\nviz2 <- ggplot(popular_districts,\n               aes(\n                 x = reorder(RANK, -RANK),\n                 y = NUMBER_OF_SALES,\n                 fill = QUARTER\n               )) +\n  geom_bar(\n    stat = \"identity\",\n    position = \"dodge\",\n    show.legend = FALSE,\n    alpha = 0.8\n  ) +\n  geom_text(aes(\n    y = 10,\n    hjust = 0,\n    label = paste0(\n      \"D\",\n      POSTAL_DISTRICT,\n      \": \",\n      NUMBER_OF_SALES,\n      \" units sold at S$\",\n      MEDIAN_PRICE_PSF,\n      \" psf\"\n    )\n  ), family = \"Roboto Condensed\") +\n  coord_flip(ylim = c(0, 600)) +\n  scale_fill_manual(values = c(\"grey45\", \"blue\")) +\n  facet_grid(TYPE_OF_SALE ~ QUARTER, switch = \"both\") +\n  theme_minimal() +\n  plot_annotation(title = \"Districts With Highest Units Sold for each Submarket\",\n                  subtitle = \"New Sale Market is heavily influenced by the newly-launched projects in **D23** (Lumina Grand) and **D26** (Lentor Mansion).\",\n                  caption = \"Prices shown are **median unit price** per sqft\") &\n  theme(\n    text = element_text(family = \"Roboto Condensed\"),\n    axis.line.x = element_line(),\n    axis.title.x = element_blank(),\n    axis.title.y = element_blank(),\n    axis.text.y = element_blank(),\n    plot.title = element_text(face = \"bold\"),\n    plot.subtitle = element_markdown(color = \"grey50\", size = rel(0.9)),\n    plot.caption = element_markdown(color = \"grey50\"),\n    strip.placement = \"outside\",\n    strip.text = element_text(size = rel(1))\n  )\nviz2\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n::: callout-tip\n#### Insights\n\nPlotting the most popular districts for each submarket reveals that the Top 5 districts in the **New Sale** market, differs for the 2 quarters.\n\nIn 2023Q1, the distribution is more balanced and there were a lot of units sold in expensive districts like **Districts 9** and **10**. However, In 2024Q1, the number of units sold were skewed towards cheaper districts like **Districts 23** and **26** where big projects like [Lumina Grand](https://www.99.co/singapore/condos-apartments/lumina-grand) and [Lentor Mansion](https://www.99.co/singapore/condos-apartments/lentor-mansion), respectively, were launched.\n\nThis is why the overall prices in the New Sale market appear to be much cheaper than the previous year, when in fact the new projects that launched are in **cheaper districts**.\n\nOn the contrary, the top districts in the Resale and Sub Sale markets have much less difference. This smaller change also resulted in a smaller impact on the overall median price in these markets.\n:::\n\n## 4.3 Diving deep into the 2024 Q1 Market\n\n\n::: {.cell}\n\n```{.r .cell-code}\nq12024 <- realis_per_unit %>% filter(QUARTER==\"2024Q1\")\n\nggplot(q12024, aes(x=PROPERTY_TYPE, fill=TYPE_OF_SALE)) +\n  geom_bar() +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(q12024, aes(x=PROPERTY_TYPE, y=TRANSACTED_PRICE/1000, fill=PROPERTY_TYPE)) +\n  geom_violin() +\n  geom_hline(yintercept=median(q12024$TRANSACTED_PRICE)/1000, color = \"red\") +\n  geom_hline(yintercept=mean(q12024$TRANSACTED_PRICE)/1000) +\n  scale_y_log10() +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nq1_2024_aggregated = q12024 %>% group_by(TYPE_OF_SALE, PROPERTY_TYPE) %>% summarize(\n  COUNT = n(),\n  MEDIAN_PRICE = median(TRANSACTED_PRICE),\n  MEAN_PRICE = mean(TRANSACTED_PRICE),\n  MIN_PRICE = min(TRANSACTED_PRICE),\n  MAX_PRICE = max(TRANSACTED_PRICE),\n)\nggplot(q1_2024_aggregated, aes(area=COUNT, fill = TYPE_OF_SALE,\n               label = TYPE_OF_SALE, subgroup = PROPERTY_TYPE)) +\n  geom_treemap()\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex1_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\n# 5 Summary\n\n# 6 References\n\nLim, Abram. (2024). 13+ Housing & Household Statistics in Singapore (2024).*SmartWealth Singapore*. <https://smartwealth.sg/housing-household-statistics-singapore/>\n\nTrading Economics. (2024). *Home Ownership Rate \\| G20*. <https://tradingeconomics.com/country-list/home-ownership-rate?continent=g20>\n\n<https://www.dbs.com.sg/personal/articles/nav/my-home/cooling-measures-in-singapore>\n\n[https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r](https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/https://www.cedricscherer.com/2019/08/05/a-ggplot2-tutorial-for-beautiful-plotting-in-r/){.uri}\n\n<https://www.propertyguru.com.sg/property-guides/singapore-property-market-outlook-2024-90041#1>\n\n<https://akalestale.netlify.app/take-home_ex/take-home_ex01/take-home_ex01> (stat_halfeye usage)\n\n<https://sape.inf.usi.ch/quick-reference/ggplot2/colour>\n\n<https://www.redbrick.sg/blog/landed-property-singapore/>\n",
    "supporting": [
      "Take-home_Ex1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}