{
  "hash": "e2634ebd0ff9772af7638d68f9adf29d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take Home Ex3: VAST Challenge 2024 Mini-Challenge 3 [WIP]\"\nauthor: \"Kristine Joy Paas\"\ndate: \"22 May 2024\"\ndate-modified: \"last-modified\"\nformat: html\nexecute: \n  echo: true\n  eval: true\n  warning: false\n  freeze: true\n---\n\n\n# Setup\n\n## Loading Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(jsonlite, tidyverse, ggraph, tidygraph, visNetwork, patchwork, ggtext, knitr, igraph)\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n## Loading Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_data <- fromJSON(\"data/mc3.json\")\n```\n:::\n\n\n# Data Wrangling\n\n## Extracting Nodes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_nodes <- as_tibble(mc3_data$nodes) %>%\n  mutate(\n    id = as.character(id),\n    subtype = strsplit(type, \".\", fixed=TRUE) %>% sapply(tail, n=1),\n    type = strsplit(type, \".\", fixed=TRUE) %>% sapply('[', 2)\n  ) %>%\n  select(id, type, subtype)\n\nmc3_nodes %>% head(n = 10) %>% kable()\n```\n\n::: {.cell-output-display}\n\n\n|id                          |type         |subtype |\n|:---------------------------|:------------|:-------|\n|Abbott, Mcbride and Edwards |Organization |Company |\n|Abbott-Gomez                |Organization |Company |\n|Abbott-Harrison             |Organization |Company |\n|Abbott-Ibarra               |Organization |Company |\n|Abbott-Sullivan             |Organization |Company |\n|Acevedo and Sons            |Organization |Company |\n|Acevedo PLC                 |Organization |Company |\n|Acevedo, Lloyd and Young    |Organization |Company |\n|Acevedo, Miller and Edwards |Organization |Company |\n|Acevedo, Thompson and Myers |Organization |Company |\n\n\n:::\n:::\n\n\n## Extracting Edges\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_edges <- as_tibble(mc3_data$links) %>%\n  mutate(\n    from = as.character(source),\n    to = as.character(target),\n    subtype = strsplit(type, \".\", fixed = TRUE) %>% sapply(tail, n = 1),\n    type = ifelse(\n      grepl(\"Event.Owns\", type),\n      \"Ownership\",\n      ifelse(grepl(\"Relationship\", type), \"Relationship\", \"Employment\")\n    )\n  ) %>%\n  select(from, to, type, subtype) %>%\n  distinct() %>%\n  filter(from != to)\n\nmc3_edges %>% head(n = 10) %>% kable()\n```\n\n::: {.cell-output-display}\n\n\n|from                           |to                            |type      |subtype         |\n|:------------------------------|:-----------------------------|:---------|:---------------|\n|Avery Inc                      |Allen, Nichols and Thompson   |Ownership |Shareholdership |\n|Berger-Hayes                   |Jensen, Morris and Downs      |Ownership |Shareholdership |\n|Bowers Group                   |Barnett Inc                   |Ownership |Shareholdership |\n|Bowman-Howe                    |Bennett Ltd                   |Ownership |Shareholdership |\n|Boyd and Sons                  |Armstrong, Bennett and Deleon |Ownership |Shareholdership |\n|Brown-Johnson                  |Alexander-Wagner              |Ownership |Shareholdership |\n|Burke, Hernandez and Alexander |Becker-Mckinney               |Ownership |Shareholdership |\n|Cain, Rodriguez and Gonzales   |Beck-Green                    |Ownership |Shareholdership |\n|Choi, Ortiz and Goodwin        |Barton, King and Hall         |Ownership |Shareholdership |\n|Cochran Ltd                    |Crosby Ltd                    |Ownership |Shareholdership |\n\n\n:::\n:::\n\n\n# Questions\n\n## Q4: Relations with SouthSeafood Express Corp\n\n### Direct Relations\n\n#### Edges\n\n\n::: {.cell}\n\n```{.r .cell-code}\nssfec_edges <- mc3_edges %>%\n  filter(from == \"SouthSeafood Express Corp\" |\n           to == \"SouthSeafood Express Corp\")\nssfec_edges %>% kable()\n```\n\n::: {.cell-output-display}\n\n\n|from                   |to                        |type      |subtype         |\n|:----------------------|:-------------------------|:---------|:---------------|\n|AguaLeska Transit N.V. |SouthSeafood Express Corp |Ownership |Shareholdership |\n|Tainamarine Fishing Co |SouthSeafood Express Corp |Ownership |Shareholdership |\n\n\n:::\n:::\n\n\n#### Nodes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nssfec_nodes <- mc3_nodes %>%\n  filter(id %in% ssfec_edges$from |\n           id %in% ssfec_edges$to) %>%\n  mutate(\n    focus = (id == \"SouthSeafood Express Corp\")\n  )\nssfec_nodes %>% kable()\n```\n\n::: {.cell-output-display}\n\n\n|id                        |type         |subtype        |focus |\n|:-------------------------|:------------|:--------------|:-----|\n|AguaLeska Transit N.V.    |Organization |FishingCompany |FALSE |\n|SouthSeafood Express Corp |Organization |FishingCompany |TRUE  |\n|Tainamarine Fishing Co    |Organization |FishingCompany |FALSE |\n\n\n:::\n:::\n\n\n#### Graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nssfec_graph <- tbl_graph(nodes = ssfec_nodes, edges = ssfec_edges, directed = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggraph(ssfec_graph, layout = \"linear\", circular = TRUE) +\n  \n  # Render nodes\n  geom_node_point(aes(color = focus), show.legend = FALSE, size = 30) +\n  geom_node_text(\n    aes(label = str_wrap(id, width = -1)),\n    family = font_family,\n    size = 3,\n    color = \"white\"\n  ) +\n  scale_color_manual(values = c(\"blue\", \"gold3\")) +\n  \n  # Render edges\n  geom_edge_link(\n    aes(label = subtype),\n    # Control arrow\n    arrow = arrow(type = \"closed\", length = unit(0.025, \"npc\")),\n    end_cap = circle(12, \"mm\"),\n    start_cap = circle(12, \"mm\"),\n    # Format labels\n    angle_calc = \"along\",\n    label_dodge = unit(0.04, \"npc\"),\n    family = font_family,\n    show.legend = FALSE\n  ) +\n  \n  # Hack to reduce distance between nodes\n  # This is to not clip the nodes in the edge of the plot\n  # ref: https://stackoverflow.com/a/66991383\n  ylim(-1.3, 0.8) +\n  xlim(-1, 1) +\n  \n  # Style graph\n  unset_graph_style() +\n  theme_graph(base_family = font_family, plot_margin = margin(0)) +\n  plot_annotation(title = \"SouthSeafood Express Corp's Direct Network\", subtitle = \"Two other fishing companies, <span style='color:blue;'>**AguaLeska Transit N.V.**</span> and <span style='color:blue;'>**Tainamarine Fishing Co**</span> hold shares in<br />SouthSeafood Express Corp.\") &\n  theme(\n    text = element_text(family = font_family),\n    plot.title = element_text(face = \"bold\", size = rel(1.4)),\n    plot.subtitle = element_markdown(color = \"grey50\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex3_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### Distance-based\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngraph <- graph_from_data_frame(mc3_edges, vertices = mc3_nodes)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nssfec_node = which(V(graph)$name == \"SouthSeafood Express Corp\")\ndists <- distances(graph, v = ssfec_node) %>%\n  as.data.frame() %>%\n  pivot_longer(cols = mc3_nodes$id, names_to = \"name\", values_to = \"distance\")\n```\n:::\n\n\n# References\n\n<https://blogs.cornell.edu/info2040/2015/10/19/three-degrees-of-influence-how-far-can-you-reach-people/>\n",
    "supporting": [
      "Take-home_Ex3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}